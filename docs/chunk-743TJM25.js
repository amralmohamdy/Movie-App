import{a as _e}from"./chunk-SGQGAOMW.js";import{a as xe}from"./chunk-FJ6JWJHS.js";import{c as pe,d as fe}from"./chunk-QU2DSLHC.js";import{I as ue}from"./chunk-ZR5CBTAD.js";import{$ as Q,Aa as P,Ba as l,Bb as me,C as h,Ca as v,D as b,Da as m,E as z,F as U,J as C,Ma as Y,Oa as J,Pa as R,Q as k,R as $,Ra as d,Sa as _,T as n,Ta as W,Ua as F,X as O,Xa as X,Y as A,ba as M,cb as Z,e as V,ea as f,eb as ee,fa as u,ga as D,hb as te,ia as w,ib as ie,ja as y,jb as ne,ka as x,la as o,lb as ae,ma as a,na as p,qb as oe,ra as B,rb as re,sa as T,sb as le,ua as s,ub as se,va as j,vb as de,wa as K,xa as H,y as g,ya as q,yb as ce,za as G}from"./chunk-G3D7CDXJ.js";var I=class t{constructor(i){this.sanitizer=i}transform(i){return this.sanitizer.bypassSecurityTrustResourceUrl(i)}static \u0275fac=function(e){return new(e||t)(O(oe,16))};static \u0275pipe=Q({name:"safe",type:t,pure:!0})};var ge=["trailerModal"],he=()=>[1,2,3,4,5],be=(t,i)=>({"text-yellow-400":t,"text-gray-300 dark:text-gray-500":i}),Ce=(t,i,e)=>({"bg-success text-white":t,"bg-error text-white":i,"bg-info text-white":e}),we=(t,i,e)=>({"bg-success/70":t,"bg-error/70":i,"bg-info/70":e}),ye=(t,i)=>i.id;function Te(t,i){t&1&&p(0,"app-skeleton",2)}function Ee(t,i){if(t&1&&(o(0,"div",3),l(1),a()),t&2){let e=s();n(),m("\u274C Error: ",e.hasError.message)}}function ke(t,i){if(t&1&&(o(0,"p",33),l(1),a()),t&2){let e=s(2);n(),m(' "',e.film.tagline,'" ')}}function De(t,i){if(t&1&&(o(0,"div",17)(1,"div",34)(2,"div",35),l(3),d(4,"translate"),a()(),o(5,"span",36),p(6,"i",37),l(7),a()()),t&2){let e=s(2);n(3),v(_(4,2,"details.duration")),n(4),m(" ",e.formatRuntime(e.film.runtime)," ")}}function Ie(t,i){if(t&1&&p(0,"i",38),t&2){let e=i.$implicit,r=s(3);x("ngClass",J(1,be,e<r.math(r.film.vote_average),e>=r.math(r.film.vote_average)))}}function Se(t,i){t&1&&(o(0,"div",19),w(1,Ie,1,4,"i",38,D),a()),t&2&&(n(),y(Y(0,he)))}function Me(t,i){if(t&1&&(o(0,"a",27),l(1),a()),t&2){let e=i.$implicit;x("routerLink","/genres/"+e.id),n(),v(e.name)}}function Be(t,i){t&1&&l(0,",")}function Pe(t,i){t&1&&l(0,".")}function Re(t,i){if(t&1&&(l(0),f(1,Be,1,0)(2,Pe,1,0)),t&2){let e=i.$implicit,r=i.$index,c=s(3);m(" ",e.english_name+" ("+e.name+")"," "),n(),u(r+1<c.film.spoken_languages.length?1:2)}}function We(t,i){if(t&1&&(o(0,"div")(1,"strong"),l(2),d(3,"translate"),a(),w(4,Re,3,2,null,null,D),a()),t&2){let e=s(2);n(2),m("",_(3,1,"details.language"),":"),n(2),y(e.film.spoken_languages)}}function Fe(t,i){if(t&1&&(o(0,"div",30)(1,"strong"),l(2,"Production:"),a(),o(3,"div",39)(4,"div",34)(5,"div",35),l(6),a()(),p(7,"img",40),a()()),t&2){let e=s(2);n(6),v(e.film.production_companies[0].name),n(),x("src",e.imageBase+e.film.production_companies[0].logo_path,k)}}function Le(t,i){if(t&1&&(o(0,"div")(1,"strong"),l(2),d(3,"translate"),a(),l(4),d(5,"currency"),a()),t&2){let e=s(2);n(2),m("",_(3,2,"details.budget"),":"),n(2),m(" ",F(5,4,e.film.budget,"USD","symbol"))}}function Ne(t,i){if(t&1&&(o(0,"div")(1,"strong"),l(2),d(3,"translate"),a(),l(4),d(5,"currency"),a()),t&2){let e=s(2);n(2),m("",_(3,2,"details.revenue"),":"),n(2),m(" ",F(5,4,e.film.revenue,"USD","symbol"))}}function Ve(t,i){if(t&1&&(o(0,"a",32),l(1),d(2,"translate"),a()),t&2){let e=s(2);x("href",e.film.homepage,k),n(),v(_(2,2,"details.website"))}}function ze(t,i){if(t&1){let e=B();o(0,"a",41),T("click",function(c){h(e);let S=q(6),E=s(2);return E.openModal(E.trailerKey),c.preventDefault(),b(S.showModal())}),z(),o(1,"svg",42),p(2,"path",43),a(),l(3),d(4,"translate"),a(),U(),o(5,"dialog",44,0),T("click",function(){h(e);let c=s(2);return b(c.closeModal())}),o(7,"div",45)(8,"form",46)(9,"button",47),T("click",function(){h(e);let c=s(2);return b(c.closeModal())}),l(10," \u2715 "),a()(),o(11,"div",48),p(12,"iframe",49),d(13,"safe"),a()()()}if(t&2){let e=s(2);n(3),m(" ",_(4,2,"details.playTrailer")," "),n(9),x("src",_(13,4,e.youtubeUrl),$)}}function Ue(t,i){if(t&1&&p(0,"app-item",54),t&2){let e=i.$implicit;x("film",e)}}function $e(t,i){if(t&1&&(p(0,"div",50),o(1,"div",51)(2,"h3",52),l(3),d(4,"translate"),a(),o(5,"div",53),w(6,Ue,1,1,"app-item",54,ye),a()()),t&2){let e=s(2);n(3),v(_(4,1,"details.recommendations")),n(3),y(e.recommendations)}}function Oe(t,i){if(t&1){let e=B();o(0,"div",5)(1,"div",6),p(2,"img",7),a(),o(3,"div",8)(4,"div",9)(5,"h1",10),l(6),a(),o(7,"button",11),T("click",function(){h(e);let c=s();return b(c.toggleWishlist())}),p(8,"i",12),a()(),M(9,ke,2,1,"p",13),o(10,"div",14)(11,"span",15),p(12,"i",16),l(13),d(14,"date"),a(),f(15,De,8,4,"div",17),a(),o(16,"div",18),f(17,Se,3,1,"div",19),o(18,"span",20),l(19),d(20,"number"),a(),o(21,"span",21),l(22),d(23,"number"),a()(),o(24,"div",22)(25,"h3",23),l(26),d(27,"translate"),a(),o(28,"p",24),l(29),a()(),o(30,"div",25)(31,"h3",23),l(32),d(33,"translate"),a(),o(34,"div",26),w(35,Me,2,2,"a",27,D),a()(),p(37,"div",28),o(38,"div",29),f(39,We,6,3,"div"),f(40,Fe,8,2,"div",30),f(41,Le,6,8,"div"),f(42,Ne,6,8,"div"),a(),o(43,"div",31),f(44,Ve,3,4,"a",32),f(45,ze,14,6),a()()(),f(46,$e,8,3)}if(t&2){let e=s();n(2),x("src",e.film.poster_path?e.imageBase+e.film.poster_path:"imgnotfound.png",k)("alt",e.film.title),n(4),v(e.film.title),n(),P("bg-error",e.isInWishlist())("text-white",e.isInWishlist()),n(),P("fa-heart-crack",e.isInWishlist())("fa-heart",!e.isInWishlist()),n(),x("ngIf",e.film.tagline),n(4),m(" ",W(14,27,e.film.release_date,"mediumDate")," "),n(2),u(e.film.runtime?15:-1),n(2),u(e.film.vote_average!=null?17:-1),n(2),m("",W(20,30,e.film.vote_average/2,"1.1-1"),"/5"),n(3),m("votes: ",_(23,33,e.film.vote_count)),n(4),v(_(27,35,"details.overview")),n(3),m(" ",e.film.overview," "),n(3),v(_(33,37,"details.genres")),n(3),y(e.film.genres),n(4),u(e.film.spoken_languages.length?39:-1),n(),u(e.film.production_companies.length>0?40:-1),n(),u(e.film.budget?41:-1),n(),u(e.film.revenue?42:-1),n(2),u(e.film.homepage?44:-1),n(),u(e.trailerKey?45:-1),n(),u(e.recommendations.length>0?46:-1)}}function Ae(t,i){if(t&1&&(o(0,"div",55)(1,"div",56)(2,"span"),l(3),a(),p(4,"div",57),a()()),t&2){let e=s();n(),x("ngClass",R(5,Ce,e.toastType()==="success",e.toastType()==="error",e.toastType()==="info")),n(2),v(e.toastMessage()),n(),G("width",e.toastProgress()*100,"%"),x("ngClass",R(9,we,e.toastType()==="success",e.toastType()==="error",e.toastType()==="info"))}}var L=class t{trailerModal;router=g(se);route=g(le);svc=g(pe);WishlistResourceSvc=g(fe);auth=g(ue);showToast=C(!1);toastMessage=C("");toastType=C("info");toastProgress=C(0);isTrailerOpen=!1;youtubeUrl="";openModal(i){this.isTrailerOpen=!0,this.youtubeUrl=`https://www.youtube.com/embed/${i}?autoplay=1`,this.trailerModal.nativeElement.showModal()}closeModal(){this.isTrailerOpen=!1,this.youtubeUrl=null,this.trailerModal.nativeElement.close()}onBackdropClick(i){let e=this.trailerModal.nativeElement;i.target===e&&this.closeModal()}imageBase="https://image.tmdb.org/t/p/w500";ngOnInit(){this.route.paramMap.subscribe(i=>{let e=Number(i.get("id"));e&&!isNaN(e)&&this.svc.id.set(e)}),this.router.events.subscribe(i=>{i instanceof re&&window.scrollTo({top:0,behavior:"smooth"})})}get film(){return this.svc.movieDetails.value()}get recommendations(){return(this.svc.movieRecommendations.value()?.results??[]).filter(r=>r.genre_ids?.includes(16)).slice(0,6)}get trailerKey(){let e=(this.svc.movieTrailer.value()?.results??[]).find(r=>r.site?.toLowerCase()==="youtube"&&(r.type?.toLowerCase()==="trailer"||r.type?.toLowerCase()==="teaser"));return e?e.key:null}get isLoadingAll(){return this.svc.movieDetails.isLoading()||this.svc.movieTrailer.isLoading()||this.svc.movieRecommendations.isLoading()}get hasError(){return this.svc.movieDetails.error()||this.svc.movieTrailer.error()||this.svc.movieRecommendations.error()}formatRuntime(i){if(!i)return"\u2014";let e=Math.floor(i/60),r=i%60;return e>0?`${e}h ${r}m`:`${r}m`}math(i){return i/2}isInWishlist=X(()=>{if(this.film?.id)return this.WishlistResourceSvc.wishlistIds().includes(this.film.id)});toggleWishlist(){return V(this,null,function*(){if(!this.auth.currentUser){this.showToastMessage("You must be logged in to save movies!","error");return}this.isInWishlist()?(yield this.WishlistResourceSvc.removeItem(this.film.id),this.showToastMessage("Removed from your wishlist.","info")):(yield this.WishlistResourceSvc.addItem(this.film.id),this.showToastMessage("Added to your wishlist!","success"))})}showToastMessage(i,e="info",r=4e3){this.toastMessage.set(i),this.toastType.set(e),this.showToast.set(!0),this.toastProgress.set(0);let c=20,S=c/r,E=setInterval(()=>{let N=this.toastProgress()+S;N>=1?(this.toastProgress.set(1),this.showToast.set(!1),clearInterval(E)):this.toastProgress.set(N)},c)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=A({type:t,selectors:[["app-details"]],viewQuery:function(e,r){if(e&1&&j(ge,5),e&2){let c;K(c=H())&&(r.trailerModal=c.first)}},decls:5,vars:2,consts:[["trailerModal",""],[1,"page-container","p-4","md:p-8"],["type","details"],[1,"error","text-error","text-lg","text-center","mt-8"],["class","fixed top-4 right-4 z-50 transition-all duration-300",4,"ngIf"],[1,"details-card","flex","flex-col","md:flex-row","gap-8","p-6","md:p-10","bg-base-100","dark:bg-base-200","rounded-3xl","shadow-2xl","transition-all"],[1,"left","flex-shrink-0","w-full","md:w-1/3","max-w-sm","mx-auto","md:mx-0"],[1,"poster","w-full","rounded-2xl","shadow-xl","transition-transform","hover:scale-105",3,"src","alt"],[1,"right","flex-1","flex","flex-col"],[1,"header-row","flex","flex-col","md:flex-row","justify-between","items-start","md:items-center","gap-2","md:gap-0"],[1,"title","text-3xl","md:text-4xl","font-extrabold"],["aria-label","Favorite button",1,"btn","btn-circle","btn-lg","shadow-lg","backdrop-blur-sm","transition-all","border-2","border-base-200","dark:border-base-100","hover:bg-error","hover:text-white",3,"click"],[1,"fa-solid"],["class","tagline text-base text-muted mt-1 italic",4,"ngIf"],[1,"meta","flex","flex-wrap","gap-4","mt-4","items-center","text-sm","text-gray-500","dark:text-gray-300"],[1,"flex","items-center","gap-1","my-text","cursor-default"],[1,"fas","fa-calendar-alt"],[1,"tooltip"],[1,"flex","items-center","gap-3","mt-3"],[1,"stars","flex","items-center","gap-1"],[1,"text-sm","font-semibold"],[1,"text-sm","opacity-70"],[1,"mt-6"],[1,"text-lg","font-semibold","mb-2","my-text"],[1,"p-4","rounded-xl","bg-base-200/60","dark:bg-base-300/40","text-base-content","text-sm","md:text-base","leading-relaxed","shadow-sm","border","border-base-300/40","backdrop-blur-sm"],[1,"genres","mt-4"],[1,"flex","flex-wrap","gap-2"],[1,"btn","btn-outline","btn-warning",3,"routerLink"],[1,"divider","mb-0"],[1,"extras","mt-5","grid","grid-cols-1","sm:grid-cols-2","gap-2","text-sm"],[1,"flex","flex-wrap","items-center"],[1,"buttons","flex","flex-wrap","gap-3","mt-6"],["target","_blank","rel","noopener",1,"btn","btn-primary","transition-transform","hover:scale-105",3,"href"],[1,"tagline","text-base","text-muted","mt-1","italic"],[1,"tooltip-content"],[1,"text-white-400"],["data-tip","duration",1,"flex","items-center","gap-1","my-text","cursor-default"],[1,"fas","fa-clock"],[1,"fa-solid","fa-star","w-5","h-5",3,"ngClass"],[1,"tooltip","w-25"],[1,"mx-2",3,"src"],[1,"btn","btn-outline","flex","items-center","gap-2","transition-transform","hover:scale-105",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4"],["d","M4 4l12 6-12 6V4z"],[1,"modal",3,"click"],[1,"modal-box","max-w-3xl","bg-base-200"],["method","dialog"],[1,"btn","btn-sm","btn-circle","btn-ghost","absolute","right-3","top-3",3,"click"],[1,"aspect-video","mt-4","rounded-xl","overflow-hidden"],["width","100%","height","100%","frameborder","0","allow","autoplay; encrypted-media","allowfullscreen","",3,"src"],[1,"divider","mt-10"],[1,"recommendations"],[1,"text-xl","font-semibold","mb-3"],[1,"rec-row","grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-6","gap-4"],[3,"film"],[1,"fixed","top-4","right-4","z-50","transition-all","duration-300"],[1,"alert","shadow-lg","rounded-xl","border","border-base-300","dark:border-base-100","relative","overflow-hidden",3,"ngClass"],[1,"absolute","top-0","left-0","h-1",3,"ngClass"]],template:function(e,r){e&1&&(o(0,"div",1),f(1,Te,1,0,"app-skeleton",2)(2,Ee,2,1,"div",3)(3,Oe,47,39),a(),M(4,Ae,5,13,"div",4)),e&2&&(n(),u(r.isLoadingAll?1:r.hasError?2:r.film?3:-1),n(3),x("ngIf",r.showToast()))},dependencies:[ae,Z,ee,ce,de,_e,xe,ie,ne,te,I,me],styles:[".my-text[_ngcontent-%COMP%]{background:var(--hover-color);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;color:transparent}.my-text[_ngcontent-%COMP%]:hover{background:var(--primary-color);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;color:transparent}"]})};export{L as default};
