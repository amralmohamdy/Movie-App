import{a as q}from"./chunk-SGQGAOMW.js";import{a as U}from"./chunk-FJ6JWJHS.js";import{c as G}from"./chunk-QU2DSLHC.js";import"./chunk-ZR5CBTAD.js";import{Aa as M,Ab as L,Ba as l,Bb as O,C as u,Ca as I,D as g,Da as w,Ea as N,J as d,Na as F,Ra as v,Sa as f,T as a,Xa as E,Y as R,cb as $,e as _,ea as C,fa as x,ga as j,ia as y,ja as k,ka as b,la as s,lb as A,ma as r,na as T,ra as h,sa as c,ua as p,y as P}from"./chunk-G3D7CDXJ.js";var z=n=>({"my-btn text-white":n}),H=(n,i)=>i.id;function J(n,i){n&1&&T(0,"app-skeleton",4),n&2&&b("type","list")}function K(n,i){if(n&1&&(s(0,"div",5),l(1),r()),n&2){let e=p();a(),I(e.error())}}function Q(n,i){if(n&1&&T(0,"app-item",9),n&2){let e=i.$implicit;b("film",e)}}function W(n,i){if(n&1&&(s(0,"div",6),y(1,Q,1,1,"app-item",9,H),r()),n&2){let e=p();a(),k(e.movies())}}function X(n,i){n&1&&(s(0,"div",7),l(1),v(2,"translate"),r()),n&2&&(a(),I(f(2,1,"browse.nof")))}function Y(n,i){if(n&1){let e=h();s(0,"button",13),c("click",function(){u(e);let o=p(2);return g(o.changePage(o.visiblePages()[0]-1))}),l(1," \u2026"),r()}}function Z(n,i){if(n&1){let e=h();s(0,"button",14),c("click",function(){let o=u(e).$implicit,m=p(2);return g(m.changePage(o))}),l(1),r()}if(n&2){let e=i.$implicit,t=p(2);b("ngClass",F(2,z,t.page()===e)),a(),w(" ",e," ")}}function ee(n,i){if(n&1){let e=h();s(0,"button",13),c("click",function(){u(e);let o=p(2);return g(o.changePage(o.visiblePages()[o.visiblePages().length-1]+1))}),l(1," \u2026"),r()}}function te(n,i){if(n&1){let e=h();s(0,"div",8)(1,"button",10),c("click",function(){u(e);let o=p();return g(o.prevPage())}),l(2,"\xAB"),r(),C(3,Y,2,0,"button",11),y(4,Z,2,4,"button",12,j),C(6,ee,2,0,"button",11),s(7,"button",10),c("click",function(){u(e);let o=p();return g(o.nextPage())}),l(8," \xBB "),r()()}if(n&2){let e=p();a(),b("disabled",e.page()===1),a(2),x(e.visiblePages()[0]>1?3:-1),a(),k(e.visiblePages()),a(2),x(e.visiblePages()[e.visiblePages().length-1]<e.totalPages()?6:-1),a(),b("disabled",e.page()===e.totalPages())}}var S=class n{translate=P(L);moviesResources=P(G);IMAGE_BASE="https://image.tmdb.org/t/p/w300";movies=d([]);loading=d(!1);error=d(null);mode=d("popular");modeLabel=E(()=>{let i=this.mode(),e;return i==="popular"?e="browse.popular":i==="top_rated"?e="browse.topRated":e="browse.upcoming",this.translate.instant(e)});page=d(1);totalPages=d(1);visiblePages=E(()=>{let i=this.page(),e=this.totalPages(),t=5,o=Math.floor(t/2),m=Math.max(1,i-o),V=Math.min(e,m+t-1);m=Math.max(1,V-t+1);let D=[];for(let B=m;B<=V;B++)D.push(B);return D});ngOnInit(){return _(this,null,function*(){yield this.loadByMode(this.mode(),this.page())})}setMode(i){this.mode()!==i&&(this.mode.set(i),this.page.set(1),this.loadByMode(i,1))}loadByMode(i,e=1){return _(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t,o=this.moviesResources.lang();i==="popular"?t=this.moviesResources.fetchPopularMovies:i==="top_rated"?t=this.moviesResources.fetchTopRatedMovies:t=this.moviesResources.fetchUpcomingMovies;let m=yield t.call(this.moviesResources,e,o);this.movies.set(m.results??[]),this.totalPages.set(m.total_pages??1)}catch(t){this.error.set(t instanceof Error?t.message:`Failed to load ${i} movies: ${String(t)}`),this.movies.set([]),this.totalPages.set(1)}finally{this.loading.set(!1)}})}changePage(i){return _(this,null,function*(){i=Math.max(1,Math.min(i,this.totalPages())),this.page.set(i),yield this.loadByMode(this.mode(),i)})}nextPage(){return _(this,null,function*(){yield this.changePage(this.page()+1)})}prevPage(){return _(this,null,function*(){yield this.changePage(this.page()-1)})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=R({type:n,selectors:[["app-browse"]],decls:19,vars:21,consts:[[1,"container","mx-auto","p-4"],[1,"text-2xl","font-semibold","mb-4"],[1,"flex","flex-wrap","gap-2","mb-4"],[1,"btn","px-3","py-2","rounded-full","border",3,"click"],[3,"type"],[1,"text-error","text-center"],[1,"grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-4","lg:grid-cols-5","gap-4","my-8"],[1,"py-8","text-center","text-muted"],[1,"join","flex","justify-center","mt-8"],[3,"film"],[1,"join-item","btn",3,"click","disabled"],[1,"join-item","btn"],[1,"join-item","btn",3,"ngClass"],[1,"join-item","btn",3,"click"],[1,"join-item","btn",3,"click","ngClass"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"h1",1),l(2),v(3,"translate"),r(),s(4,"div",2)(5,"button",3),c("click",function(){return t.setMode("popular")}),l(6),v(7,"translate"),r(),s(8,"button",3),c("click",function(){return t.setMode("top_rated")}),l(9),v(10,"translate"),r(),s(11,"button",3),c("click",function(){return t.setMode("upcoming")}),l(12),v(13,"translate"),r()(),C(14,J,1,1,"app-skeleton",4)(15,K,2,1,"div",5)(16,W,3,0,"div",6)(17,X,3,3,"div",7),C(18,te,9,4,"div",8),r()),e&2&&(a(2),N("",f(3,13,"browse.title")," \u2013 ",t.modeLabel()),a(3),M("my-btn",t.mode()==="popular"),a(),w(" ",f(7,15,"browse.popular")," "),a(2),M("my-btn",t.mode()==="top_rated"),a(),w(" ",f(10,17,"browse.topRated")," "),a(2),M("my-btn",t.mode()==="upcoming"),a(),w(" ",f(13,19,"browse.upcoming")," "),a(2),x(t.loading()?14:t.error()?15:!t.loading()&&!t.error()?16:!t.loading()&&t.movies().length===0?17:-1),a(4),x(t.totalPages()>1?18:-1))},dependencies:[A,$,U,q,O],encapsulation:2})};export{S as default};
