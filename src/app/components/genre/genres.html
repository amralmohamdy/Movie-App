<div class="container mx-auto p-4">
  <h1 class="text-2xl font-semibold mb-4">Genres</h1>

  <!-- Genres skeleton / error -->
  @if(loadingGenres()){
  <app-skeleton [type]="'btns'"></app-skeleton>
  } @else if(errorGenres()){
  <div class="text-error-500 mb-4">{{ errorGenres() }}</div>
  }

  <!-- Genres buttons -->
  <div class="flex flex-wrap gap-2 mb-6">
    <button
      class="btn btn-ghost btn-outline border px-3 py-2 rounded-full"
      [class.my-btn]="selectedGenreId() === null || selectedGenreId() === 0"
      [class.text-white]="selectedGenreId() === null || selectedGenreId() === 0"
      (click)="selectGenre(0)" routerLink="/genres"
    >
      All
    </button>

    @for(g of genres(); track g.id){
    <button
      class="btn btn-ghost btn-outline border px-3 py-2 rounded-full"
      [class.my-btn]="selectedGenreId() === g.id"
      [class.text-white]="selectedGenreId() === g.id"
      [routerLink]="'/genres/' + g.id"
    >
      {{ g.name }}
    </button>
    }
  </div>

  <!-- Movies skeleton / error / list -->
  @if(loadingMovies()){
  <app-skeleton [type]="'list'"></app-skeleton>
  } @else if(errorMovies()){
  <div class="text-red-500">{{ errorMovies() }}</div>
  } @else if(!loadingMovies() && !errorMovies()){
  <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 my-8">
    @for(m of movies(); track m.id){
    <app-item [film]="m"></app-item>
    }
  </div>
  } @else if(!loadingMovies() && movies().length === 0){
  <div class="py-8 text-center text-muted">No movies found for this genre.</div>
  }

  <!-- Pagination -->
  <div class="join flex justify-center mt-8">
    <button class="join-item btn" [disabled]="page() === 1" (click)="prevPage()">«</button>

    @if(visiblePages()[0] > 1){
    <button class="join-item btn" (click)="changePage(visiblePages()[0] - 1)">…</button>
    } @for(p of visiblePages(); track p){
    <button
      class="join-item btn"
      [class.my-btn]="page() === p"
      [class.text-white]="page() === p"
      (click)="changePage(p)"
    >
      {{ p }}
    </button>
    } @if(visiblePages()[visiblePages().length - 1] < totalPages()){
    <button
      class="join-item btn"
      (click)="changePage(visiblePages()[visiblePages().length - 1] + 1)"
    >
      …
    </button>
    }

    <button class="join-item btn" [disabled]="page() === totalPages()" (click)="nextPage()">
      »
    </button>
  </div>
</div>
